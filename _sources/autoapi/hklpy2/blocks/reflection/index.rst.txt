hklpy2.blocks.reflection
========================

.. py:module:: hklpy2.blocks.reflection

.. autoapi-nested-parse::

   Coordinates of a crystalline reflection.

   Associates diffractometer angles (real-space) with crystalline reciprocal-space
   (pseudo) coordinates.

   .. autosummary::

       ~Reflection
       ~ReflectionsDict
       ~UNUSED_REFLECTION



Attributes
----------

.. autoapisummary::

   hklpy2.blocks.reflection.logger
   hklpy2.blocks.reflection.DEFAULT_REFLECTION_DIGITS
   hklpy2.blocks.reflection.UNUSED_REFLECTION


Classes
-------

.. autoapisummary::

   hklpy2.blocks.reflection.Reflection
   hklpy2.blocks.reflection.ReflectionsDict


Module Contents
---------------

.. py:data:: logger

.. py:data:: DEFAULT_REFLECTION_DIGITS
   :type:  int
   :value: 4


.. py:data:: UNUSED_REFLECTION
   :type:  str
   :value: 'unused'


   Identifies an unused reflection in the ReflectionsDict.

.. py:class:: Reflection(name: str, pseudos: hklpy2.misc.NamedFloatDict, reals: hklpy2.misc.NamedFloatDict, wavelength: float, geometry: str, pseudo_axis_names: list[str], real_axis_names: list[str], *, core: Optional[hklpy2.ops.Core] = None, digits: Optional[int] = None, reals_units: Optional[str] = None, wavelength_units: str = None)

   Coordinates real and pseudo axes.

   Two reflections can be added, subtracted, or compared for equality.

   .. note:: Internal use only.

      It is expected this class is called from a method of
      :class:`~hklpy2.ops.Core`, not directly by the user.

   .. rubric:: Parameters

   * ``name`` (str): Reference name for this reflection.
   * ``pseudos`` (dict): Unordered dictionary of pseudo-space axes and values.
   * ``reals`` (dict): Unordered dictionary of real-space axes and values.
   * ``wavelength`` (float): Wavelength of incident radiation.
   * ``geometry`` (str): Geometry name for this reflection.
   * ``pseudo_names`` ([str]): Ordered list of pseudo names for this geometry.
   * ``rnames`` ([str]): Ordered list of real names for this geometry.
   * ``wavelength_units`` (str): Engineering units of wavelength.

   Optional items (such as 'azimuth', 'h1', 'h2', zones, ...) are not
   part of a "reflection".

   .. autosummary::

       ~__add__
       ~__eq__
       ~__sub__
       ~_asdict
       ~_fromdict
       ~_validate_pseudos
       ~_validate_reals
       ~_validate_wavelength
       ~pseudos
       ~reals
       ~wavelength


   .. py:attribute:: digits
      :value: 4



   .. py:attribute:: geometry


   .. py:property:: name
      :type: str


      Sample name.


   .. py:attribute:: pseudo_axis_names


   .. py:attribute:: real_axis_names


   .. py:property:: pseudos
      :type: hklpy2.misc.NamedFloatDict


      Ordered dictionary of diffractometer's reciprocal-space axes.

      Dictionary keys are the axis names, as defined by the diffractometer.


   .. py:property:: reals
      :type: hklpy2.misc.NamedFloatDict


      Ordered dictionary of diffractometer's real-space axes.

      Dictionary keys are the axis names, as defined by the diffractometer.


   .. py:property:: reals_units
      :type: str


      Engineering units of this reflection's real-space axes.


   .. py:property:: wavelength
      :type: float


      Wavelength of reflection.


   .. py:property:: wavelength_units
      :type: str


      Engineering units of this reflection's wavelength.


   .. py:method:: __add__(other: object) -> object

      Add a Reflection object to this one and return as a new Reflection.

      Combines the pseudos and reals of self and other.



   .. py:method:: __eq__(r2: object) -> bool

      Compare this reflection with another for equality.

      Precision is controlled by rounding to smallest number of digits
      between the reflections.



   .. py:method:: __repr__() -> str

      Standard brief representation of reflection.



   .. py:method:: __sub__(other: object) -> object

      Subtract another Reflection from this one and return as a new Reflection.

      Subtracts the pseudos and reals of other from self.



   .. py:method:: _asdict() -> Mapping[str, Union[float, int, str]]

      Describe this reflection as a dictionary.



   .. py:method:: _fromdict(config: Mapping[str, Union[float, int, str]])

      Redefine this reflection from a (configuration) dictionary.



   .. py:method:: _validate_pseudos(value: hklpy2.misc.NamedFloatDict)

      Raise Exception if pseudos do not match expectations.



   .. py:method:: _validate_reals(value: hklpy2.misc.NamedFloatDict)

      Raise Exception if reals do not match expectations.



   .. py:method:: _validate_wavelength(value: float)

      Raise exception if pseudos do not match expectations.



.. py:class:: ReflectionsDict(*args, **kwargs)

   Bases: :py:obj:`dict`


   Dictionary of Reflections.

   .. autosummary::

       ~_asdict
       ~_fromdict
       ~_validate_reflection
       ~add
       ~order
       ~prune
       ~set_orientation_reflections
       ~setor
       ~swap


   .. py:attribute:: _order
      :value: []



   .. py:attribute:: geometry
      :value: None



   .. py:method:: _asdict() -> Mapping[str, Union[float, int, str]]

      Describe the reflections list as an ordered dictionary.

      Order by reflections order.



   .. py:method:: _fromdict(config: Mapping[str, Union[float, int, str]], core=None) -> None

      Add or redefine reflections from a (configuration) dictionary.



   .. py:method:: set_orientation_reflections(reflections: list[Reflection]) -> None

      Designate the order of the reflections to be used.

      .. note:: Raises ``KeyError`` if any
         ``reflections`` are not already defined.

         This method does not *add* any new reflections.

      .. rubric:: Parameters

      * ``reflections`` ([Reflection]) : List of
        :class:`hklpy2.blocks.reflection.Reflection` objects.



   .. py:attribute:: setor

      Common alias for :meth:`~set_orientation_reflections`.


   .. py:method:: add(reflection: Reflection, replace: bool = False) -> None

      Add a single orientation reflection.



   .. py:method:: prune() -> None

      Remove any undefined reflections from order list.



   .. py:method:: swap() -> list[Reflection]

      Swap the first two orientation reflections.



   .. py:method:: _validate_reflection(reflection: Reflection, replace: bool) -> None

      Validate the new reflection (raise exception if invalid).



   .. py:property:: order
      :type: list[Reflection]


      Ordered list of reflection names used for orientation.


